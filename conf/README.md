# README: Руководство по Конфигурации (`conf/`)

Добро пожаловать в "Центр Управления" нашего фреймворка! В этой директории находятся все `.yaml` файлы конфигурации, которые управляют **каждым** аспектом работы — от генерации признаков до обучения моделей и стекинга.

В основе нашей системы лежит библиотека **Hydra**. Понимание ее философии — ключ к эффективному использованию всего фреймворка.

## 1. 🎯 Философия Hydra: Композиция, а не Модификация

**Главный принцип:** Мы не редактируем один гигантский `config.yaml` для каждого эксперимента. Вместо этого, мы **собираем (композируем)** нужную нам конфигурацию из маленьких, переиспользуемых "кирпичиков".

*   **"Кирпичик"** — это один `.yaml` файл, описывающий один компонент (например, `lgbm.yaml` описывает модель LightGBM, `roc_auc.yaml` — метрику ROC AUC).
*   **"Сборочный чертеж"** — это файл в `conf/experiment/`, который говорит, из каких "кирпичиков" собрать данный конкретный эксперимент.

---

## 2. ⚙️ Основы Работы с Hydra

### 2.1. Группы Конфигураций и `defaults`

Каждая подпапка внутри `conf/` (например, `model/`, `metric/`) является **группой конфигураций**. Файлы внутри нее — это **опции** для этой группы.

Связь между ними устанавливается в главном файле `conf/config.yaml` через список `defaults`:

```yaml
# conf/config.yaml
defaults:
  - experiment: ~
  - model: lgbm      # 👈 "Для группы 'model', по умолчанию используй опцию 'lgbm'"
  - metric: roc_auc  # 👈 "Для группы 'metric', по умолчанию используй опцию 'roc_auc'"
  - _self_
```
Это означает, что `lgbm.yaml` и `roc_auc.yaml` будут загружены по умолчанию.

### 2.2. Переопределение из Командной Строки (Ключевая возможность)

Вы можете "на лету" заменить любой компонент или изменить любой параметр, не трогая файлы.

*   **Заменить компонент:**
    ```bash
    # Запустить обучение, но вместо lgbm использовать catboost
    python src/train.py model=catboost
    ```

*   **Изменить параметр:**
    ```bash
    # Запустить lgbm, но с другим learning_rate
    python src/train.py model.params.learning_rate=0.01
    ```

---

## 3. 🗺️ Анатомия Эксперимента: Основные Папки

Мы используем три "сборочные" папки для описания высокоуровневых задач.

### 3.1. `conf/experiment/` — "Сборочный цех" для Обучения

*   **Назначение:** Каждый файл здесь — это **полная спецификация для одного эксперимента по обучению (`train.py`)**. Он определяет, какую модель, на каких признаках и с какими параметрами обучать.
*   **Пример (`exp001_lgbm_baseline.yaml`):**
    ```yaml
    defaults:
      - override /model: lgbm
      - override /features: v1_baseline
      # ...
    ```
*   **Как использовать:**
    ```bash
    python src/train.py experiment=exp001_lgbm_baseline
    ```

### 3.2. `conf/inference/` — Конфигурации для Предсказаний

*   **Назначение:** Каждый файл здесь описывает, **из какого успешного эксперимента** (указанного по его `run_id`) нужно сделать предсказание (`predict.py`).
*   **Пример (`inf_exp001.yaml`):**
    ```yaml
    run_id: "abcdef12" # ID запуска из W&B
    defaults:
      - experiment: exp001_lgbm_baseline # Наследуем конфиг для согласованности
      - _self_
    ```
*   **Как использовать:**
    ```bash
    python src/predict.py inference=inf_exp001
    ```

### 3.3. `conf/stacking/`, `conf/tuning/`, `conf/selection/`

*   Аналогично, эти папки содержат "сборочные" конфиги для соответствующих скриптов: `stack.py`, `tune.py` и `select_features.py`.

---

## 4. 🧱 Справочник по "Компонентам" Конфигурации

Ниже приведено краткое описание каждой папки с "кирпичиками", из которых собираются ваши эксперименты. **Для получения подробной информации о настройке каждого компонента, обратитесь к `README.md` внутри соответствующей папки.**

*   **`conf/data/`**
    *   **Роль:** Определяет пути к данным (`raw`, `processed`, `features` и т.д.).
    *   > 📖 Детали: `(ссылка на будущий conf/data/README.md)`

*   **`conf/feature_engineering/`**
    *   **Роль:** Описывает конвейеры для генерации признаков. Каждый файл — это один "рецепт" создания набора признаков.
    *   > 📖 Детали: **[Руководство по Фиче-Инжинирингу (conf/feature_engineering/README.md)](./feature_engineering/README.md)**

*   **`conf/features/`**
    *   **Роль:** Содержит списки колонок, которые будут использоваться в модели. Позволяет легко переключаться между полным набором признаков и урезанным (после отбора).
    *   > 📖 Детали: `(ссылка на будущий conf/features/README.md)`

*   **`conf/metric/`**
    *   **Роль:** Определяет основную и дополнительные метрики для оценки модели.
    *   > 📖 Детали: **[Руководство по Метрикам (conf/metric/README.md)](./metric/README.md)**

*   **`conf/model/`**
    *   **Роль:** "Библиотека" доступных моделей. Каждый файл описывает одну модель и ее гиперпараметры.
    *   > 📖 Детали: **[Руководство по Моделям (conf/model/README.md)](./model/README.md)**

*   **`conf/training/`**
    *   **Роль:** Настраивает параметры самого процесса обучения (например, `early_stopping_rounds`, флаг `full_data`).
    *   > 📖 Детали: `(ссылка на будущий conf/training/README.md)`

*   **`conf/validation/`**
    *   **Роль:** Определяет стратегию кросс-валидации (`StratifiedKFold`, `GroupKFold` и т.д.).
    *   > 📖 Детали: `(ссылка на будущий conf/validation/README.md)`

*   **`conf/wandb/`**
    *   **Роль:** Настраивает интеграцию с Weights & Biases (имя проекта, пользователь, теги).
    *   > 📖 Детали: `(ссылка на будущий conf/wandb/README.md)`