# README: –ú–æ–¥—É–ª—å –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ú–æ–¥–µ–ª—è–º–∏ (`src/models/`)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞. –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ (LightGBM, XGBoost, CatBoost –∏ –¥—Ä.).

## 1. üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: "–í–∫–ª—é—á–∏ –∏ –†–∞–±–æ—Ç–∞–π" (Plug-and-Play)

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è ‚Äî **–∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞—Ç—å** –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è (`train.py`) –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –¥–≤—É—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

1.  **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ú–æ–¥–µ–ª–∏ (`src/models/base.py`):** –≠—Ç–æ "–∫–æ–Ω—Ç—Ä–∞–∫—Ç" –∏–ª–∏ "—Ä–æ–∑–µ—Ç–∫–∞", –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã (`fit`, `predict_proba`, `save`, `load`) –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –ª—é–±–∞—è –º–æ–¥–µ–ª—å, —á—Ç–æ–±—ã –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π —Å –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–æ–π.
2.  **–ö–ª–∞—Å—Å—ã-–û–±–µ—Ä—Ç–∫–∏ (`src/models/lgbm.py`, `src/models/xgb.py` –∏ —Ç.–¥.):** –≠—Ç–æ "–≤–∏–ª–∫–∏" –¥–ª—è –Ω–∞—à–∏—Ö –º–æ–¥–µ–ª–µ–π. –ö–∞–∂–¥—ã–π —Ç–∞–∫–æ–π –∫–ª–∞—Å—Å "–æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç" –º–æ–¥–µ–ª—å –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `lightgbm.LGBMClassifier`) –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–µ—Ç–æ–¥—ã, —Ç—Ä–µ–±—É–µ–º—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ, –Ω–∞—à `train.py` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–π –º–æ–¥–µ–ª—å—é –æ–¥–∏–Ω–∞–∫–æ–≤–æ, –∫–∞–∫ —Å "—á–µ—Ä–Ω—ã–º —è—â–∏–∫–æ–º", –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –µ–¥–∏–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É.**

## 2. üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü–∞–ø–æ–∫

```
src/
‚îî‚îÄ‚îÄ models/
    ‚îú‚îÄ‚îÄ __init__.py   # –î–µ–ª–∞–µ—Ç 'models' –ø–∞–∫–µ—Ç–æ–º
    ‚îú‚îÄ‚îÄ base.py       # –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å ModelInterface
    ‚îú‚îÄ‚îÄ lgbm.py       # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è LightGBM
    ‚îú‚îÄ‚îÄ xgb.py        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è XGBoost
    ‚îî‚îÄ‚îÄ catboost.py   # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è CatBoost
```

---

## 3. ‚öôÔ∏è –ö–∞–∫ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ú–æ–¥–µ–ª–∏: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ YAML

**–í—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ YAML-—Ñ–∞–π–ª–∞—Ö –≤ –ø–∞–ø–∫–µ `conf/model/`.**

–ö–∞–∂–¥—ã–π `.yaml` —Ñ–∞–π–ª –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–¥–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –º–æ–¥–µ–ª—å –∏ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π "—Å–±–æ—Ä–∫–æ–π".

#### –ê–Ω–∞—Ç–æ–º–∏—è —Ñ–∞–π–ª–∞ `conf/model/lgbm.yaml`:
```yaml
# 1. –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ Python-–∫–ª–∞—Å—Å (—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å!)
# Hydra –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å —ç—Ç–æ—Ç –∫–ª–∞—Å—Å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –µ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä.
_target_: src.models.lgbm.LGBMModel

# 2. –°–ª–æ–≤–∞—Ä—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞.
# –í—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –∑–¥–µ—Å—å –õ–Æ–ë–´–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç
# lightgbm.LGBMClassifier.
params:
  objective: "binary"
  metric: "auc"
  n_estimators: 1000
  learning_rate: 0.05
  n_jobs: -1
  seed: ${globals.seed} # –°—Å—ã–ª–∫–∞ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–∏–¥
  
  # –ü—Ä–∏–º–µ—Ä—ã –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
  # max_depth: 7
  # num_leaves: 31
  # reg_alpha: 0.1
  # colsample_bytree: 0.8
```

## 4. üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –ü—Ä–∏–º–µ—Ä—ã –†–∞–±–æ—Ç—ã

–í–æ—Ç –∫–∞–∫ –≤—ã –±—É–¥–µ—Ç–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –º–æ–¥–µ–ª—è–º–∏ –≤ 99% —Å–ª—É—á–∞–µ–≤.

#### –ü—Ä–∏–º–µ—Ä 1: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–í –≥–ª–∞–≤–Ω–æ–º `config.yaml` —É –Ω–∞—Å –ø—Ä–æ–ø–∏—Å–∞–Ω–æ:
```yaml
defaults:
  - model: lgbm
  # ...
```
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ LightGBM —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—à–µ–π –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª—å—é.

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python src/train.py
```
**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1.  Hydra –≤–∏–¥–∏—Ç, —á—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±—Ä–∞–Ω–∞ –æ–ø—Ü–∏—è `lgbm` –¥–ª—è –≥—Ä—É–ø–ø—ã `model`.
2.  –û–Ω–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç `conf/model/lgbm.yaml`.
3.  –û–Ω–∞ —Å–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `src.models.lgbm.LGBMModel`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–º—É –≤ `__init__` –≤–µ—Å—å —Å–ª–æ–≤–∞—Ä—å `params`.
4.  –°–∫—Ä–∏–ø—Ç `train.py` –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–æ—Ç –≥–æ—Ç–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–∞ –Ω–µ–º `.fit()`.

---

#### –ü—Ä–∏–º–µ—Ä 2: –ë—ã—Å—Ç—Ä—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª—å—é (CatBoost)

–í—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è CatBoost –Ω–∞ —Ç–æ–º –∂–µ –Ω–∞–±–æ—Ä–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python src.train.py model=catboost
```
**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1.  –ê—Ä–≥—É–º–µ–Ω—Ç `model=catboost` –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ **–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç** –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`model: lgbm`).
2.  Hydra —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç `conf/model/catboost.yaml`.
3.  –°–æ–∑–¥–∞–µ—Ç—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä `src.models.catboost.CatBoostModel`.
4.  `train.py` –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ CatBoost, –Ω–µ –∑–∞–º–µ—Ç–∏–≤ "–ø–æ–¥–º–µ–Ω—ã", —Ç–∞–∫ –∫–∞–∫ –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∏–º–µ–µ—Ç —Ç–µ –∂–µ —Å–∞–º—ã–µ –º–µ—Ç–æ–¥—ã.

---

#### –ü—Ä–∏–º–µ—Ä 3: –¢—é–Ω–∏–Ω–≥ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ "–Ω–∞ –ª–µ—Ç—É"

–í—ã –ø–æ–ª—É—á–∏–ª–∏ —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å LGBM, –Ω–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ —Å—Ç–∞–Ω–µ—Ç –ª–∏ –æ–Ω –ª—É—á—à–µ —Å –º–µ–Ω—å—à–∏–º `learning_rate` –∏ –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–µ—Ä–µ–≤—å–µ–≤.

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python src/train.py model.params.learning_rate=0.02 model.params.n_estimators=2500
```
**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1.  Hydra –∑–∞–≥—Ä—É–∂–∞–µ—Ç `conf/model/lgbm.yaml` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
2.  –ó–∞—Ç–µ–º –æ–Ω–∞ "–ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è" –ø–æ –ø—É—Ç–∏ `model -> params -> learning_rate` –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `0.05` –Ω–∞ `0.02`.
3.  –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –æ–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç `n_estimators`.
4.  –í –∏—Ç–æ–≥–µ, –∫–ª–∞—Å—Å `LGBMModel` —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å —É–∂–µ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

---

## 5. ‚ûï –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, RandomForest)?

–ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–Ω–∏–º–∞–µ—Ç 5 –º–∏–Ω—É—Ç.

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å-–æ–±–µ—Ä—Ç–∫—É.**
–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `src/models/sklearn_rf.py`.

```python
# src/models/sklearn_rf.py
from typing import Any, Dict
import joblib
import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from .base import ModelInterface

class RandomForestModel(ModelInterface):
    def __init__(self, params: Dict[str, Any]):
        self.params = params
        self.model = RandomForestClassifier(**self.params)

    # ... —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –≤—Å–µ –º–µ—Ç–æ–¥—ã: fit, predict_proba, save, load ...
```

**–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å YAML-–∫–æ–Ω—Ñ–∏–≥.**
–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `conf/model/rf.yaml`.

```yaml
# conf/model/rf.yaml
_target_: src.models.sklearn_rf.RandomForestModel

params:
  n_estimators: 500
  max_depth: 10
  min_samples_leaf: 50
  n_jobs: -1
  random_state: ${globals.seed}
```

**–®–∞–≥ 3: –ì–æ—Ç–æ–≤–æ!**
–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ —Å –≤–∞—à–µ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é.

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python src/train.py model=rf
```

–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–µ–ª–∞–µ—Ç –≤–∞—à —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –≥–∏–±–∫–∏–º –∏ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º, –ø–æ–∑–≤–æ–ª—è—è –≤–∞–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö, –∞ –Ω–µ –Ω–∞ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–∏ –∫–æ–¥–∞.