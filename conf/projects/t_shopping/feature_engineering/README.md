# README: –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ö–æ–Ω–≤–µ–π–µ—Ä–∞–º –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ (`conf/feature_engineering/`)

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è ‚Äî –≤–∞—à "—Ü–µ—Ö –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤". –ö–∞–∂–¥—ã–π `.yaml` —Ñ–∞–π–ª –∑–¥–µ—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–∫–æ–Ω–≤–µ–π–µ—Ä (pipeline)** ‚Äî –ø–æ—à–∞–≥–æ–≤—ã–π "—Ä–µ—Ü–µ–ø—Ç" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–°–∫—Ä–∏–ø—Ç `make_features.py` –±–µ—Ä–µ—Ç –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –Ω–µ–º —à–∞–≥–∏.

## 1. üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è: –û—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É

–ò–¥–µ—è –∫–æ–Ω–≤–µ–π–µ—Ä–∞ ‚Äî –≤—ã–ø–æ–ª–Ω—è—Ç—å —à–∞–≥–∏ –≤ –ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –í—ã –Ω–∞—á–∏–Ω–∞–µ—Ç–µ —Å –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π, –∞ –∑–∞—Ç–µ–º –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–æ–∏—Ç–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ.

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –∫–æ–Ω–≤–µ–π–µ—Ä–∞:**
1.  –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º **–±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** –∏–∑ –¥–∞—Ç (`DatetimeFeatureGenerator`).
2.  –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ–º **–∞–≥—Ä–µ–≥–∞—Ü–∏–∏**, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –º–µ—Å—è—Ü–∞–º).
3.  –ó–∞—Ç–µ–º **–∫–æ–¥–∏—Ä—É–µ–º** –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (`TargetEncoder`).
4.  –í –∫–æ–Ω—Ü–µ, –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –æ–±—É—á–∞–µ–º **–∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

## 2. ‚öôÔ∏è –ê–Ω–∞—Ç–æ–º–∏—è –§–∞–π–ª–∞ –ö–æ–Ω–≤–µ–π–µ—Ä–∞

–ö–∞–∂–¥—ã–π `.yaml` —Ñ–∞–π–ª –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ –∏–º–µ–µ—Ç –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏: `name` –∏ `pipeline`.

**–ü—Ä–∏–º–µ—Ä: `conf/feature_engineering/v1_baseline.yaml`**
```yaml
# 1. –ò–º—è –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ W&B)
# –≠—Ç–æ –∏–º—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤ .parquet –∏ –≤ W&B.
name: "v1_baseline"

# 2. –°–ø–∏—Å–æ–∫ —à–∞–≥–æ–≤ –∫–æ–Ω–≤–µ–π–µ—Ä–∞
# `make_features.py` –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —ç—Ç–∏ —à–∞–≥–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑.
pipeline:
  # --- –®–ê–ì 1: –ò–∑–≤–ª–µ—á—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ –¥–∞—Ç—ã ---
  - _target_: src.features.datetime.DatetimeFeatureGenerator
    name: "date_features"
    cols: ["transaction_date"]
    components: ["weekday", "month", "year"]

  # --- –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å —Ñ–ª–∞–≥–∏ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ ---
  - _target_: src.features.numerical.flags.IsNullIndicator
    name: "null_flags"
    cols: ["user_age", "user_city"]
    
  # --- –®–ê–ì 3: –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ---
  - _target_: src.features.categorical.nominal.CountFrequencyEncoderGenerator
    name: "count_encode_cats"
    cols: ["user_city", "product_category"]
    normalize: false
```

### –ö–ª—é—á–µ–≤—ã–µ –≠–ª–µ–º–µ–Ω—Ç—ã –®–∞–≥–∞

*   `_target_`: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π.** –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ Python-–∫–ª–∞—Å—Å—É `FeatureGenerator`, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ.
*   `name`: **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π.** –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –¥–ª—è —ç—Ç–æ–≥–æ —à–∞–≥–∞, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –ª–æ–≥–∞—Ö.
*   **–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (`cols`, `components`, `normalize` –∏ —Ç.–¥.): –≠—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `__init__` –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∫–ª–∞—Å—Å–∞-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞.

---

## 3. üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`v2`), –¥–æ–±–∞–≤–∏–≤ –∫ –±–∞–∑–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—É (`v1`) –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.

**–®–∞–≥ 1: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ñ–∏–≥**
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `v1_baseline.yaml` –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `v2_with_aggs.yaml`.

**–®–∞–≥ 2: –ò–∑–º–µ–Ω–∏—Ç–µ –∏–º—è**
–í –Ω–æ–≤–æ–º —Ñ–∞–π–ª–µ –∏–∑–º–µ–Ω–∏—Ç–µ `name`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.
```yaml
name: "v2_with_aggs"
```

**–®–∞–≥ 3: –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —à–∞–≥ –≤ `pipeline`**
–î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ `pipeline` –Ω–æ–≤—ã–π –±–ª–æ–∫ –¥–ª—è `AggregationGenerator`.

**`conf/feature_engineering/v2_with_aggs.yaml`:**
```yaml
name: "v2_with_aggs"

pipeline:
  # ... (–≤—Å–µ —à–∞–≥–∏ –∏–∑ v1_baseline.yaml –æ—Å—Ç–∞—é—Ç—Å—è –∑–¥–µ—Å—å) ...
  - _target_: src.features.datetime.DatetimeFeatureGenerator
    # ...
  - _target_: src.features.numerical.flags.IsNullIndicator
    # ...
  - _target_: src.features.categorical.nominal.CountFrequencyEncoderGenerator
    # ...

  # --- –ù–û–í–´–ô –®–ê–ì 4: –î–æ–±–∞–≤–ª—è–µ–º –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ ---
  - _target_: src.features.aggregation.AggregationGenerator
    name: "user_aggregations"
    group_keys: ["user_id"]
    group_values: ["transaction_amount"]
    agg_funcs: ["mean", "sum", "std"]
```

**–®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é**
–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏—Ç–µ `make_features.py`, —É–∫–∞–∑–∞–≤ –µ–º—É –Ω–æ–≤—ã–π "—Ä–µ—Ü–µ–ø—Ç":
```bash
python src/make_features.py feature_engineering=v2_with_aggs
```
–ò–ª–∏ —á–µ—Ä–µ–∑ `Makefile`, –µ—Å–ª–∏ –≤—ã –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ `feature_engineering`.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
*   –ë—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –∏–∑ 4 —à–∞–≥–æ–≤.
*   –í `data/03_features/` –ø–æ—è–≤—è—Ç—Å—è —Ñ–∞–π–ª—ã `train_v2_with_aggs.parquet` –∏ `test_v2_with_aggs.parquet`.
*   –í W&B –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç `v2_with_aggs`.

## 4. üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞–º

–≠—Ç–æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –æ–≥—Ä–æ–º–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –≥–æ—Ç–æ–≤—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∏ –∫–∞–∫–∏–µ —É –Ω–µ–≥–æ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

> üìñ **[–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ (src/features/README.md)](../src/features/README.md)**

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω–≤–µ–π–µ—Ä–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—è "–∫–∏—Ä–ø–∏—á–∏–∫–∏" –≤ YAML, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ç—Ä–æ–≥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥.